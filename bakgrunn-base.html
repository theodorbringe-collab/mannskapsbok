<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Depotstyring</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background: #f4f6f9;
    }

    .container {
      padding: 40px;
      max-width: 1200px;
      margin: auto;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .card h2 {
      margin-top: 0;
      font-size: 24px;
      color: #333;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .toolbar input,
    .toolbar select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }

    .button {
      background: #1976d2;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    }

    .button:hover {
      background: #125ea9;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      text-align: left;
      padding: 12px;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #e9ecef;
      font-weight: bold;
    }

    .plukk-seksjon {
      margin-top: 30px;
    }

    .plukk-seksjon h3 {
      margin-bottom: 10px;
    }

    .plukk-seksjon ul {
      list-style: none;
      padding-left: 0;
    }

    .plukk-seksjon li {
      padding: 5px 0;
    }

    .status-lav {
      color: red;
      font-weight: bold;
    }

    .status-ok {
      color: green;
    }

    .header-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .fulloversikt {
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-toolbar">
      <button class="button" onclick="window.location.href='modulvalg.html'">‚Üê Tilbake til startside</button>
      <button class="button" onclick="visFullDepotOversikt()">üìã Full depotoversikt</button>
    </div>

    <div class="card">
      <h2>Depotstyring</h2>

      <div class="toolbar">
        <select id="omr√•deSelect" onchange="velgOmr√•de(this.value)"></select>
        <input type="text" id="nyttOmr√•de" placeholder="Nytt omr√•de" />
        <button class="button" onclick="leggTilOmr√•de()">‚ûï Nytt omr√•de</button>
      </div>

      <div class="toolbar">
        <select id="kategoriSelect" onchange="velgKategori(this.value)"></select>
        <input type="text" id="nyKategori" placeholder="Ny kategori" />
        <button class="button" onclick="leggTilKategori()">‚ûï Ny kategori</button>
      </div>

      <div id="kategori-innhold" style="margin-top: 30px;"></div>
    </div>

    <div class="card fulloversikt" id="full-oversikt" style="display:none;"></div>
  </div>

  <script>
    let lagerdata = {
      "Depot A": {
        "Bekledning": [
          { navn: "Uniform", antall: 10, status: "ok" }
        ]
      },
      "Depot B": {
        "Verneutstyr": [
          { navn: "Hjelm", antall: 3, status: "lav" }
        ]
      }
    };

    let valgtOmr√•de = "Depot A";
    let valgtKategori = "Bekledning";
    let plukkliste = [];

    function init() {
      oppdaterOmr√•deValg();
      velgOmr√•de(valgtOmr√•de);
    }

    function oppdaterOmr√•deValg() {
      const select = document.getElementById('omr√•deSelect');
      select.innerHTML = '';
      for (let omr√•de in lagerdata) {
        select.innerHTML += `<option value="${omr√•de}">${omr√•de}</option>`;
      }
      select.value = valgtOmr√•de;
    }

    function velgOmr√•de(omr√•de) {
      valgtOmr√•de = omr√•de;
      oppdaterKategoriValg();
      const f√∏rsteKategori = Object.keys(lagerdata[valgtOmr√•de])[0] || null;
      if (f√∏rsteKategori) {
        velgKategori(f√∏rsteKategori);
      } else {
        document.getElementById('kategori-innhold').innerHTML = '<p>Ingen kategorier tilgjengelig.</p>';
      }
      document.getElementById('full-oversikt').style.display = 'none';
    }

    function oppdaterKategoriValg() {
      const select = document.getElementById('kategoriSelect');
      select.innerHTML = '';
      for (let kategori in lagerdata[valgtOmr√•de]) {
        select.innerHTML += `<option value="${kategori}">${kategori}</option>`;
      }
      select.value = valgtKategori;
    }

    function velgKategori(kategori) {
      valgtKategori = kategori;
      const varer = lagerdata[valgtOmr√•de][valgtKategori] || [];
      visKategori(varer);
    }

    function leggTilOmr√•de() {
      const nytt = document.getElementById('nyttOmr√•de').value.trim();
      if (nytt && !lagerdata[nytt]) {
        lagerdata[nytt] = {};
        valgtOmr√•de = nytt;
        document.getElementById('nyttOmr√•de').value = '';
        oppdaterOmr√•deValg();
        oppdaterKategoriValg();
      }
    }

    function leggTilKategori() {
      const nyKat = document.getElementById('nyKategori').value.trim();
      if (nyKat && !lagerdata[valgtOmr√•de][nyKat]) {
        lagerdata[valgtOmr√•de][nyKat] = [];
        valgtKategori = nyKat;
        document.getElementById('nyKategori').value = '';
        oppdaterKategoriValg();
        velgKategori(nyKat);
      }
    }

    function visKategori(varer) {
      let html = `<table><thead><tr>
        <th>Navn</th><th>Antall</th><th>Status</th><th>Plukk</th><th>Uttak</th>
      </tr></thead><tbody>`;

      varer.forEach((vare, index) => {
        html += `<tr>
          <td>${vare.navn}</td>
          <td>${vare.antall}</td>
          <td class="${vare.status === 'lav' ? 'status-lav' : 'status-ok'}">${vare.status}</td>
          <td><button class="button" onclick="leggTilPlukkliste(${index})">Plukk</button></td>
          <td><button class="button" onclick="registrerUttak(${index})">Uttak</button></td>
        </tr>`;
      });

      html += "</tbody></table>";

      html += `
        <div class="plukk-seksjon">
          <h3>üßæ Plukkliste</h3>
          <ul id="plukk-visning"></ul>
        </div>
      `;

      document.getElementById("kategori-innhold").innerHTML = html;
      oppdaterPlukklisteVisning();
    }

    function leggTilPlukkliste(index) {
      const vare = lagerdata[valgtOmr√•de][valgtKategori][index];
      if (!plukkliste.includes(vare.navn)) {
        plukkliste.push(vare.navn);
      }
      oppdaterPlukklisteVisning();
    }

    function oppdaterPlukklisteVisning() {
      const ul = document.getElementById("plukk-visning");
      ul.innerHTML = "";
      plukkliste.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        ul.appendChild(li);
      });
    }

    function registrerUttak(index) {
      const vare = lagerdata[valgtOmr√•de][valgtKategori][index];
      if (vare.antall > 0) vare.antall -= 1;
      if (vare.antall <= 3) vare.status = "lav";
      else vare.status = "ok";
      visKategori(lagerdata[valgtOmr√•de][valgtKategori]);
    }

    function visFullDepotOversikt() {
      let html = `<h2>Full oversikt over depot</h2><table><thead><tr>
        <th>Omr√•de</th><th>Kategori</th><th>Navn</th><th>Antall</th><th>Status</th>
      </tr></thead><tbody>`;

      for (let omr√•de in lagerdata) {
        for (let kategori in lagerdata[omr√•de]) {
          lagerdata[omr√•de][kategori].forEach(vare => {
            html += `<tr>
              <td>${omr√•de}</td>
              <td>${kategori}</td>
              <td>${vare.navn}</td>
              <td>${vare.antall}</td>
              <td class="${vare.status === 'lav' ? 'status-lav' : 'status-ok'}">${vare.status}</td>
            </tr>`;
          });
        }
      }

      html += `</tbody></table>`;
      const oversikt = document.getElementById('full-oversikt');
      oversikt.innerHTML = html;
      oversikt.style.display = 'block';
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
